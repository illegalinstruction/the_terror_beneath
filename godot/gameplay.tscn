[gd_scene load_steps=19 format=2]

[ext_resource path="res://submarine/SUBMARINE_VISIBLE.tscn" type="PackedScene" id=1]
[ext_resource path="res://ocean/ocean-impostor_fix_2.tscn" type="PackedScene" id=2]
[ext_resource path="res://entities/jelly_01/jelly_01.tscn" type="PackedScene" id=3]
[ext_resource path="res://backdrop/wavy_coral/coral_02d.tscn" type="PackedScene" id=4]
[ext_resource path="res://backdrop/test_rocks/test_rocks.tscn" type="PackedScene" id=5]
[ext_resource path="res://backdrop/wavy_coral/coral_01a.tscn" type="PackedScene" id=6]
[ext_resource path="res://backdrop/wavy_coral/coral_01b.tscn" type="PackedScene" id=7]
[ext_resource path="res://backdrop/wavy_coral/coral_01c.tscn" type="PackedScene" id=8]
[ext_resource path="res://backdrop/wavy_coral/coral_02a.tscn" type="PackedScene" id=9]
[ext_resource path="res://backdrop/wavy_coral/coral_02c.tscn" type="PackedScene" id=10]

[sub_resource type="GDScript" id=2]
script/source = "# 
#  _the terror_               
# | |        | |              
# | |__   ___| | _____      __
# | '_ \\ / _ \\ |/ _ \\ \\ /\\ / /
# | |_) |  __/ | (_) \\ V  V / 
# |_.__/ \\___|_|\\___/ \\_/\\_/ 
#
# Copyright 2022 Oregon Institute of Technology
# 
# Permission is hereby granted, free of charge, to any person obtaining 
# a copy of this software and associated documentation files (the 
# \"Software\"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, 
# distribute, sublicense, and/or sell copies of the Software, and to 
# permit persons to whom the Software is furnished to do so, subject to 
# the following conditions:
# 
# * The above copyright notice and this permission notice shall be 
# 	included in all copies or substantial portions of the Software.
# 
# * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, 
# 	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
# 	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
#	IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
#	CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
#	TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
#	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#                                 

extends Spatial;

#----------------------------------------------------------------------------

const SUN_SURFACE_COLOUR : Color = Color(1.0, 0.95, 0.90);
const SUN_DEPTH_ATTENUATOR : Color = Color(0.93, 0.985, 0.999);

const SKY_TOP_COLOUR : Color = Color(0.188,0.639,0.89);
const SKY_HORZ_COLOUR : Color = Color(0.839,0.918,0.98);
const GND_HORZ_COLOUR : Color = Color(0.729,0.867,0.906);
const GND_BOT_COLOUR : Color = Color(0.129, 0.357, 0.494);

const MIN_X : float = 16.0;
const MAX_X : float = 10240.0;
const MIN_Y : float = -7200.0; # in meters
const MAX_Y : float = 0.95; # float on surface

const SUNLIGHT_ZONE_DEPTH : float = -200.0;
const TWILIGHT_ZONE_DEPTH : float = -800.0;
const MIDNIGHT_ZONE_DEPTH : float = -2400.0;
const ABYSSAL_ZONE_DEPTH : float = -5500.0;

const OCEAN_IMPOSTOR_DROPDOWN_DEPTH = -65.0;
#----------------------------------------------------------------------------

func _ready():
	# load savegame here, position discoveries and sub
	
	set_process(true);

	Global.set_bgm(990); # test code, please fix
	return; 

#----------------------------------------------------------------------------

func adjust_sun_by_sub_depth():
	var tmp : Color;
	tmp.r = pow(SUN_DEPTH_ATTENUATOR.r, -$kinbody_SUBMARINE.translation.y / 2.0);
	tmp.g = pow(SUN_DEPTH_ATTENUATOR.g, -$kinbody_SUBMARINE.translation.y / 2.0);
	tmp.b = pow(SUN_DEPTH_ATTENUATOR.b, -$kinbody_SUBMARINE.translation.y / 2.0);
	
	$DirectionalLight.light_color.r = SUN_SURFACE_COLOUR.r * tmp.r;
	$DirectionalLight.light_color.g = SUN_SURFACE_COLOUR.g * tmp.g;
	$DirectionalLight.light_color.b = SUN_SURFACE_COLOUR.b * tmp.b;
	
	#--- handle midnight zone
	var sky_darken_factor : float = clamp(
		(-SUNLIGHT_ZONE_DEPTH + $kinbody_SUBMARINE.translation.y) / 150.0,
		0.0, 
		1.0);
	$WorldEnvironment.environment.background_sky.sky_top_color = SKY_TOP_COLOUR * sky_darken_factor;
	$WorldEnvironment.environment.background_sky.sky_horizon_color = SKY_HORZ_COLOUR * sky_darken_factor;
	$WorldEnvironment.environment.background_sky.ground_horizon_color = GND_HORZ_COLOUR * sky_darken_factor;
	$WorldEnvironment.environment.background_sky.ground_bottom_color = GND_BOT_COLOUR * sky_darken_factor;
		
	$WorldEnvironment.environment.background_sky.sky_energy = sky_darken_factor;
	$WorldEnvironment.environment.background_sky.ground_energy = sky_darken_factor;
	
	return;

#----------------------------------------------------------------------------

func _process(delta):
	# gather input (will also get keys)
	Global.poll_joystick();
	
	# move the ocean imposter alongside the ship
	$\"ocean-impostor_fix_2\".translation.z = $kinbody_SUBMARINE.translation.z;
	if ($kinbody_SUBMARINE.translation.y < OCEAN_IMPOSTOR_DROPDOWN_DEPTH):
		$\"ocean-impostor_fix_2\".translation.y = ($kinbody_SUBMARINE.translation.y - OCEAN_IMPOSTOR_DROPDOWN_DEPTH);
	else:
		$\"ocean-impostor_fix_2\".translation.y = 0.0;
	
	adjust_sun_by_sub_depth();
	
	return;
"

[sub_resource type="GDScript" id=5]
script/source = "# 
#  _the terror_               
# | |        | |              
# | |__   ___| | _____      __
# | '_ \\ / _ \\ |/ _ \\ \\ /\\ / / 
# | |_) |  __/ | (_) \\ V  V / 
# |_.__/ \\___|_|\\___/ \\_/\\_/ 
#
# Copyright 2022 Oregon Institute of Technology
# 
# Permission is hereby granted, free of charge, to any person obtaining 
# a copy of this software and associated documentation files (the 
# \"Software\"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, 
# distribute, sublicense, and/or sell copies of the Software, and to 
# permit persons to whom the Software is furnished to do so, subject to 
# the following conditions:
# 
# * The above copyright notice and this permission notice shall be 
# 	included in all copies or substantial portions of the Software.
# 
# * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, 
# 	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
# 	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
#	IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
#	CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
#	TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
#	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#                                              
#----------------------------------------------------------------------------

extends KinematicBody

#--- tuneable local vars ----------------------------------------------------

export var DISCOVERY_RADIUS : float = 10.5; # how far the sub can be from a discovery and still daguerreotype it
export var DISCOVERY_RADIUS_ATTENUATION_WITH_DEPTH : float = 0.0025; # multiply sub depth by this, then add it to discovery radius to make it shrink at depth
export var SUBMARINE_MAX_VELOCITY : float = 2.25;
export var SUBMARINE_ACCELERATION : float = 0.00125;
export var SUBMARINE_DRAG_MULT_FACTOR : float = 0.995;
export var SUBMARINE_IDLE_BUOYANCY : float = 0.00000125;
export var SUBMARINE_TURN_SPEED : float = 0.75;

export var SUBMARINE_MAX_ELECTRICITY : float = 100;
export var SUBMARINE_MAX_O2 : float = 100;
export var SUBMARINE_MAX_SULFUR : float = 100.0;

#--- private local vars -----------------------------------------------------

var curr_electricity : float;
var curr_o2 : float;
var curr_sulfur : float;

var flash_bulb : float;

var is_facing_left : bool;

var curr_velocity : Vector3;

#----------------------------------------------------------------------------

func _ready():
	set_process(true);
	return; # Replace with function body.

#----------------------------------------------------------------------------

func _process(_ignore):
	#=========================================================================
	if (Global._left_stick_distance >= Global.ANALOGUE_DEAD_ZONE):
		# navigation
		var veloc_add : Vector3;
		veloc_add.z = Global._left_stick_x * -SUBMARINE_ACCELERATION;
		veloc_add.y = Global._left_stick_y * -SUBMARINE_ACCELERATION;
		
		curr_velocity += veloc_add;
		
		# make submarine turn around if traveling left or right
		if (Global._left_stick_x > 0):
			is_facing_left = false;
		else:
			if (Global._left_stick_x < 0):
				is_facing_left = true;
	#=========================================================================
	
	# smooth anim of the sub turning around
	if (is_facing_left):
		if (rotation_degrees.y > 0.1):
			rotation_degrees.y -= SUBMARINE_TURN_SPEED * abs(0.1 - rotation_degrees.y) / 100.0;
	else:
		if (rotation_degrees.y < 179.9):
			rotation_degrees.y += SUBMARINE_TURN_SPEED * abs(179.9 - rotation_degrees.y) / 100.0;
		
	# sub prop and fins anim
	$SUBMARINE_VISIBLE_ROOT.prop_desired_speed = (Global._left_stick_distance * 15.0); 
	$SUBMARINE_VISIBLE_ROOT.elevon_desired_angle = Global._left_stick_y * 35;
		
	# speed cap
	if (curr_velocity.length() > SUBMARINE_MAX_VELOCITY):
		curr_velocity = (curr_velocity.normalized() * SUBMARINE_MAX_VELOCITY);
		
	# buoyancy
	curr_velocity.y += SUBMARINE_IDLE_BUOYANCY;

	# drag
	curr_velocity *= SUBMARINE_DRAG_MULT_FACTOR;
	
	# let the physics run
	move_and_collide(curr_velocity);
	
	# are we above the surface? clamp to 0, bounce downwards
	if (translation.y > get_parent().MAX_Y):
		curr_velocity.y = -(curr_velocity.y / 2.0);
		translation.y = get_parent().MAX_Y; 
		
	# don't go out of bounds, either
	if (translation.z < -get_parent().MAX_X):
		translation.z = -get_parent().MAX_X;
		curr_velocity.z = -(curr_velocity.z / 2.0);

	if (translation.z > -get_parent().MIN_X):
		translation.z = -get_parent().MIN_X;
		curr_velocity.z = -(curr_velocity.z / 2.0);
	
	return;
"

[sub_resource type="CapsuleShape" id=1]
height = 2.15938

[sub_resource type="GDScript" id=6]
script/source = "# 
#  _the terror_               
# | |        | |              
# | |__   ___| | _____      __
# | '_ \\ / _ \\ |/ _ \\ \\ /\\ / /
# | |_) |  __/ | (_) \\ V  V / 
# |_.__/ \\___|_|\\___/ \\_/\\_/ 
#
# Copyright 2022 Oregon Institute of Technology
# 
# Permission is hereby granted, free of charge, to any person obtaining 
# a copy of this software and associated documentation files (the 
# \"Software\"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, 
# distribute, sublicense, and/or sell copies of the Software, and to 
# permit persons to whom the Software is furnished to do so, subject to 
# the following conditions:
# 
# * The above copyright notice and this permission notice shall be 
# 	included in all copies or substantial portions of the Software.
# 
# * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, 
# 	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
# 	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
#	IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
#	CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
#	TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
#	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#                                              

extends Camera

export var CAMERA_ACCELERATION : float = 0.125;

#----------------------------------------------------------------------------

func _ready():
	set_process(true);
	return;

#----------------------------------------------------------------------------

func _process(_ignore):
	var speed : Vector3;
	speed.z = (translation.z - $\"../kinbody_SUBMARINE\".translation.z) * CAMERA_ACCELERATION;	
	speed.y = (translation.y - $\"../kinbody_SUBMARINE\".translation.y) * CAMERA_ACCELERATION;

	translation.z -= speed.z;
	translation.y -= speed.y;
	return;
"

[sub_resource type="GDScript" id=3]
script/source = "# 
#  _the terror_               
# | |        | |              
# | |__   ___| | _____      __
# | '_ \\ / _ \\ |/ _ \\ \\ /\\ / /
# | |_) |  __/ | (_) \\ V  V / 
# |_.__/ \\___|_|\\___/ \\_/\\_/ 
#
# Copyright 2022 Oregon Institute of Technology
# 
# Permission is hereby granted, free of charge, to any person obtaining 
# a copy of this software and associated documentation files (the 
# \"Software\"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, 
# distribute, sublicense, and/or sell copies of the Software, and to 
# permit persons to whom the Software is furnished to do so, subject to 
# the following conditions:
# 
# * The above copyright notice and this permission notice shall be 
# 	included in all copies or substantial portions of the Software.
# 
# * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, 
# 	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
# 	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
#	IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
#	CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
#	TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
#	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#                                              

extends Label

func _ready():
	set_text(Timestamp.BUILD_DATE + \"\\n\" + Timestamp.BUILD_STAMP);
	if (Global.DEBUG_MODE):
		show();
	else:
		hide();
"

[sub_resource type="GDScript" id=4]
script/source = "
# 
#  _the terror_               
# | |        | |              
# | |__   ___| | _____      __
# | '_ \\ / _ \\ |/ _ \\ \\ /\\ / / 
# | |_) |  __/ | (_) \\ V  V / 
# |_.__/ \\___|_|\\___/ \\_/\\_/ 
#
# Copyright 2022 Oregon Institute of Technology
# 
# Permission is hereby granted, free of charge, to any person obtaining 
# a copy of this software and associated documentation files (the 
# \"Software\"), to deal in the Software without restriction, including 
# without limitation the rights to use, copy, modify, merge, publish, 
# distribute, sublicense, and/or sell copies of the Software, and to 
# permit persons to whom the Software is furnished to do so, subject to 
# the following conditions:
# 
# * The above copyright notice and this permission notice shall be 
# 	included in all copies or substantial portions of the Software.
# 
# * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, 
# 	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES 
# 	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
#	IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY 
#	CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, 
#	TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
#	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#                                              

extends Label

#----------------------------------------------------------------------------

func _ready():
	if (Global.DEBUG_MODE):
		set_process(true);
		show();
	else:
		hide();
	return;

#----------------------------------------------------------------------------

func _process(_ignore):
	self.set_text(\"input: left stick  deflection:\" + str(Global._left_stick_distance) + \" angle:\" + str(rad2deg(Global._left_stick_angle)) + 
		\"\\n  A: \" + str(Global._button_a) + \"  B: \" + str(Global._button_b)+ \"  X: \" + str(Global._button_x)+ \"  Y: \" + str(Global._button_y) + 
		\"\\n use joypad? \" + str(Global.use_joystick) + \"\\n \" +
		\"submarine angle: \" + str($\"../kinbody_SUBMARINE\".rotation_degrees.y) + \"\\n\" +
		\"submarine pos: \" + str($\"../kinbody_SUBMARINE\".translation) + \"\\n\" +
		\"submarine vel: \" + str($\"../kinbody_SUBMARINE\".get(\"curr_velocity\")));
"

[sub_resource type="ProceduralSky" id=7]
sky_top_color = Color( 0.188235, 0.639216, 0.890196, 1 )
ground_bottom_color = Color( 0.129412, 0.356863, 0.494118, 1 )
ground_horizon_color = Color( 0.729412, 0.866667, 0.905882, 1 )

[sub_resource type="Environment" id=8]
background_mode = 2
background_sky = SubResource( 7 )

[node name="gameplay" type="Spatial"]
script = SubResource( 2 )

[node name="kinbody_SUBMARINE" type="KinematicBody" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 7.12431, -27.1066, 0 )
axis_lock_motion_x = true
move_lock_x = true
script = SubResource( 5 )
SUBMARINE_TURN_SPEED = 3.9

[node name="SUBMARINE_VISIBLE_ROOT" parent="kinbody_SUBMARINE" instance=ExtResource( 1 )]

[node name="CollisionShape" type="CollisionShape" parent="kinbody_SUBMARINE"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.518984 )
shape = SubResource( 1 )

[node name="Camera" type="Camera" parent="."]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 15.8524, 0, 0 )
script = SubResource( 6 )

[node name="jelly_01" parent="." instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 8.33724, -1.80128, -1.42355 )

[node name="debug_git" type="Label" parent="."]
margin_left = 32.0
margin_top = 32.0
margin_right = 72.0
margin_bottom = 46.0
custom_colors/font_color = Color( 0.686275, 1, 0, 1 )
custom_colors/font_color_shadow = Color( 0, 0, 0, 1 )
custom_constants/shadow_as_outline = 0
script = SubResource( 3 )

[node name="debug_sub" type="Label" parent="."]
margin_left = 32.0
margin_top = 96.0
margin_right = 72.0
margin_bottom = 110.0
custom_colors/font_color = Color( 1, 0.498039, 0, 1 )
custom_colors/font_color_shadow = Color( 0, 0, 0, 1 )
custom_constants/shadow_as_outline = 0
script = SubResource( 4 )

[node name="DirectionalLight" type="DirectionalLight" parent="."]
transform = Transform( 0.960915, -0.219362, 0.168889, 0, 0.610048, 0.792364, -0.276845, -0.761394, 0.586204, 0, 0, 0 )
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 8 )

[node name="test_background_root" type="Spatial" parent="."]

[node name="test_rocks" parent="test_background_root" instance=ExtResource( 5 )]

[node name="test_rocks2" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.399213, 0, 0.916858, 0, 1, 0, -0.916858, 0, 0.399213, 1.34463, -5.59574, 12.4106 )

[node name="test_rocks3" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -13.0631, -12.7113 )

[node name="test_rocks4" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.0799379, 0, -0.9968, 0, 1, 0, 0.9968, 0, -0.0799379, -1.11118, -5.83021, 6.08008 )

[node name="test_rocks5" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.28828, 0, -0.957546, 0, 1, 0, 0.957546, 0, 0.28828, -1.11118, -5.83021, -5.07782 )

[node name="test_rocks6" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.223338, 0.514769, -0.827728, -0.1341, 0.857329, 0.496995, 0.965473, 0, 0.260505, -1.11118, -11.7186, -13.6878 )

[node name="test_rocks7" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.0718092, 0.216371, -0.973667, -0.0159144, 0.976311, 0.215785, 0.997291, 0, 0.0735515, -2.86671, -30.6395, -20.2533 )

[node name="test_rocks8" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.421205, 0.216371, -0.880778, -0.093348, 0.976311, 0.195199, 0.902149, 0, 0.431425, -4.53384, -30.27, -31.2798 )

[node name="test_rocks9" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.330717, 0.682156, -0.652142, -0.210647, 0.726951, 0.653583, 0.919921, -0.078779, 0.384109, -7.09437, -35.7338, -39.7884 )

[node name="test_rocks10" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.0799379, 0, -0.9968, 0, 1, 0, 0.9968, 0, -0.0799379, -17.761, -59.3904, -31.8417 )

[node name="test_rocks11" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.28828, 0, -0.957546, 0, 1, 0, 0.957546, 0, 0.28828, -17.761, -59.3904, -42.9996 )

[node name="test_rocks12" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.223338, 0.514769, -0.827728, -0.1341, 0.857329, 0.496995, 0.965473, 0, 0.260505, -17.761, -65.2789, -51.6096 )

[node name="test_rocks13" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.510783, 0, -0.85971, 0, 1, 0, 0.85971, 0, 0.510783, -0.358196, -52.3881, -139.972 )

[node name="test_rocks14" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.788612, 0, -0.614891, 0, 1, 0, 0.614891, 0, 0.788612, -6.80604, -52.3881, -149.079 )

[node name="test_rocks15" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.740192, 0.420117, -0.524993, -0.1341, 0.857329, 0.496995, 0.658888, -0.29747, 0.690925, -11.7815, -58.2765, -156.106 )

[node name="test_rocks16" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -10.3927, -23.3741 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks16" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks16/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks16" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks17" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.421205, 0.216371, -0.880778, -0.247505, 0.961688, 0.117886, 0.872541, 0.168343, 0.458621, -14.2495, -64.5329, -107.239 )

[node name="test_rocks18" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.510783, 0, -0.85971, -0.148238, 0.985022, -0.0880731, 0.846833, 0.172428, 0.503133, -10.0738, -67.5781, -218.117 )

[node name="test_rocks19" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.788612, 0, -0.614891, -0.106024, 0.985022, -0.135979, 0.605681, 0.172428, 0.7768, -16.5217, -66.0079, -227.087 )

[node name="test_rocks20" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 0.985022, -0.172428, 0, 0.172428, 0.985022, -9.71562, -46.3165, -96.0243 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks20" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks20/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks20" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks25" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.330717, 0.682156, -0.652142, -0.210647, 0.726951, 0.653583, 0.919921, -0.078779, 0.384109, -7.09437, -35.7338, -190.912 )

[node name="test_rocks26" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.28828, 0, -0.957546, 0, 1, 0, 0.957546, 0, 0.28828, -17.761, -59.3904, -194.123 )

[node name="test_rocks27" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.223338, 0.514769, -0.827728, -0.1341, 0.857329, 0.496995, 0.965473, 0, 0.260505, -17.761, -65.2789, -202.733 )

[node name="test_rocks28" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.740192, 0.420117, -0.524993, -0.1341, 0.857329, 0.496995, 0.658888, -0.29747, 0.690925, -11.7815, -58.2765, -307.229 )

[node name="test_rocks29" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.421205, 0.216371, -0.880778, -0.247505, 0.961688, 0.117886, 0.872541, 0.168343, 0.458621, -14.2495, -64.5329, -258.363 )

[node name="test_rocks30" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 0.985022, -0.172428, 0, 0.172428, 0.985022, -9.71562, -46.3165, -247.148 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks30" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks30/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks30" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks31" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.330717, 0.682156, -0.652142, -0.210647, 0.726951, 0.653583, 0.919921, -0.078779, 0.384109, -7.09437, -130.557, -410.467 )

[node name="test_rocks32" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.28828, 0, -0.957546, 0, 1, 0, 0.957546, 0, 0.28828, -8.98569, -154.214, -413.678 )

[node name="test_rocks33" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.223338, 0.514769, -0.827728, -0.1341, 0.857329, 0.496995, 0.965473, 0, 0.260505, -17.761, -160.102, -422.288 )

[node name="test_rocks34" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.740192, 0.420117, -0.524993, -0.1341, 0.857329, 0.496995, 0.658888, -0.29747, 0.690925, -11.7815, -153.1, -526.784 )

[node name="test_rocks35" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.421205, 0.216371, -0.880778, -0.247505, 0.961688, 0.117886, 0.872541, 0.168343, 0.458621, -14.2495, -159.356, -477.917 )

[node name="test_rocks36" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 0.985022, -0.172428, 0, 0.172428, 0.985022, -9.71562, -141.14, -466.703 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks36" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks36/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks36" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks37" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.378584, 0.367779, -0.84936, 0.801522, 0.589177, -0.102143, 0.462857, -0.719451, -0.517836, -52.0618, -100.351, -245.086 )

[node name="test_rocks38" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.477712, -0.208022, -0.853533, 0.835503, 0.192705, -0.514587, 0.271525, -0.958953, 0.0817456, -52.1305, -114.827, -223.311 )

[node name="test_rocks39" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.499526, 0.171484, -0.849157, 0.767186, 0.542845, -0.34168, 0.402368, -0.822139, -0.402726, -44.8486, -121.573, -220.105 )

[node name="test_rocks40" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.0673973, 0.316427, -0.946219, 0.946552, 0.279551, 0.160906, 0.315432, -0.90649, -0.280674, 31.27, -183.936, -256.451 )

[node name="test_rocks41" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.276092, -0.171437, -0.945718, 0.829924, 0.453759, -0.324544, 0.484767, -0.874478, 0.0170007, -3.48282, -155.106, -236.595 )

[node name="test_rocks42" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.679582, -0.326207, -0.657082, 0.733599, 0.302187, 0.608699, 0, -0.895696, 0.444666, -12.0805, -140.961, -250.884 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks42" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks42/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks42" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks43" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.378584, 0.367779, -0.84936, 0.801522, 0.589177, -0.102143, 0.462857, -0.719451, -0.517836, -91.3766, -100.351, -357.151 )

[node name="test_rocks44" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.477712, -0.208022, -0.853533, 0.835503, 0.192705, -0.514587, 0.271525, -0.958953, 0.0817456, -91.4454, -114.827, -335.376 )

[node name="test_rocks45" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.499526, 0.171484, -0.849157, 0.767186, 0.542845, -0.34168, 0.402368, -0.822139, -0.402726, -84.1634, -121.573, -332.171 )

[node name="test_rocks46" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.0673973, 0.316427, -0.946219, 0.946552, 0.279551, 0.160906, 0.315432, -0.90649, -0.280674, -0.159555, -183.936, -368.517 )

[node name="test_rocks47" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( -0.276092, -0.171437, -0.945718, 0.829924, 0.453759, -0.324544, 0.484767, -0.874478, 0.0170007, -42.7977, -155.106, -348.661 )

[node name="test_rocks48" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.679582, -0.326207, -0.657082, 0.733599, 0.302187, 0.608699, 0, -0.895696, 0.444666, -51.3953, -140.961, -362.949 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks48" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks48/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks48" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="test_rocks21" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.421205, 0.216371, -0.880778, -0.093348, 0.976311, 0.195199, 0.902149, 0, 0.431425, -4.53384, -72.326, -110.608 )

[node name="test_rocks22" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.510783, 0, -0.85971, 0, 1, 0, 0.85971, 0, 0.510783, -0.358196, -94.4441, -219.3 )

[node name="test_rocks23" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.788612, 0, -0.614891, 0, 1, 0, 0.614891, 0, 0.788612, -6.80604, -94.4441, -228.407 )

[node name="test_rocks24" parent="test_background_root/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -52.4487, -102.702 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks24" instance=ExtResource( 5 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -23.1208 )

[node name="test_rocks" parent="test_background_root/test_rocks/test_rocks24/test_rocks" instance=ExtResource( 5 )]
transform = Transform( 0.979768, -0.152745, 0.129322, 0.200137, 0.747757, -0.633091, 0, 0.646164, 0.763199, -1.36914, -62.951, 9.40944 )

[node name="test_rocks2" parent="test_background_root/test_rocks/test_rocks24" instance=ExtResource( 5 )]
transform = Transform( 0.929375, -0.180307, 0.322105, 0.345743, 0.119491, -0.93069, 0.129322, 0.976325, 0.173392, 8.1217, -62.2911, -47.2068 )

[node name="coral_01a" parent="test_background_root" instance=ExtResource( 6 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, -0.39727, 0 )

[node name="coral_01b" parent="test_background_root/coral_01a" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.43308, -0.692315, 0 )

[node name="coral_02a" parent="test_background_root/coral_01a" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.98856, -0.751522, 0 )

[node name="coral_02c" parent="test_background_root/coral_01a" instance=ExtResource( 10 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.36788, -1.02525, 0 )

[node name="coral_01c" parent="test_background_root/coral_01a" instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 7.63883, -1.10198, 2.5828 )

[node name="coral_02d" parent="test_background_root/coral_01a" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 9.30888, -2.14266, 0 )

[node name="coral_01b2" parent="test_background_root/coral_01a" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.18574, -5.0786, 0 )

[node name="coral_01a" parent="test_background_root/coral_01a" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.77247, -3.97513, 0 )

[node name="coral_01a2" parent="test_background_root" instance=ExtResource( 6 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 2.70273, -2.09656, -13.4209 )

[node name="coral_01b" parent="test_background_root/coral_01a2" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.43308, -0.692315, 0 )

[node name="coral_02a" parent="test_background_root/coral_01a2" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.98856, -0.751522, 0 )

[node name="coral_02c" parent="test_background_root/coral_01a2" instance=ExtResource( 10 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.36788, -1.02525, 0 )

[node name="coral_01c" parent="test_background_root/coral_01a2" instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 7.63883, -1.10198, 2.5828 )

[node name="coral_02d" parent="test_background_root/coral_01a2" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 9.30888, -2.14266, 0 )

[node name="coral_01b2" parent="test_background_root/coral_01a2" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.18574, -5.0786, 0 )

[node name="coral_01a" parent="test_background_root/coral_01a2" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.77247, -3.97513, 0 )

[node name="coral_01a3" parent="test_background_root" instance=ExtResource( 6 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -3.04232, -34.1369, -70.7005 )

[node name="coral_01b" parent="test_background_root/coral_01a3" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 3.43308, -0.692315, 0 )

[node name="coral_02a" parent="test_background_root/coral_01a3" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4.98856, -0.751522, 0 )

[node name="coral_02c" parent="test_background_root/coral_01a3" instance=ExtResource( 10 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 6.36788, -1.02525, 0 )

[node name="coral_01c" parent="test_background_root/coral_01a3" instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 7.63883, -1.10198, 2.5828 )

[node name="coral_02d" parent="test_background_root/coral_01a3" instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 9.30888, -2.14266, 0 )

[node name="coral_01b2" parent="test_background_root/coral_01a3" instance=ExtResource( 7 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -5.18574, -5.0786, 0 )

[node name="coral_01a" parent="test_background_root/coral_01a3" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -6.77247, -3.97513, 0 )

[node name="ocean-impostor_fix_2" parent="." instance=ExtResource( 2 )]
transform = Transform( -4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -2.08096, 0, 0 )
